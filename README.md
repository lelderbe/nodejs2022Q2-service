# Home Library Service

![image](https://user-images.githubusercontent.com/29270751/180639532-a62ec8dd-cbee-423d-af10-3774fa3f99c5.png)

## ✅ Prerequisites

- Git - [Download & install Git](https://git-scm.com/downloads).
- Docker and Docker compose [Download & install Docker](https://www.docker.com/products/docker-desktop/)

## 💻 How to install

```
git clone git@github.com:lelderbe/nodejs2022Q2-service.git
cd nodejs2022Q2-service
git checkout docker
```

## ⚙️ Configure application

- rename .env.example file to .env
- setup variables if needed

## 🚀 Start application

If you have `make` comand on your computer, just type `make` to see available commands. Or use commands below.

```
docker-compose up
```

This command will launch two docker containers: Postgres database and Node.js application. You can use `docker-compose up -d` to run in detached mode (in background)

## ❌ Stop application

```
docker-compose down
```

This command will stop and destroy both containers.

## 🚨 Vulnerabilities scan

```
npm run scan-node
npm run scan-pg
```

## 💥 API

To test API via swagger open http://localhost:4000/doc/ (autogenerated API documentation).

To test API via Postman use Postman collection from the root of this repository.

## 🧪 Testing

To run all tests without authorization

```
docker-compose exec node npm run test
```

To run only one of all test suites

```
docker-compose exec node npm run test -- <path to suite>
```

To run all test with authorization

```
docker-compose exec node npm run test test:auth
```

To run only specific test suite with authorization

```
docker-compose exec node npm run test test:auth -- <path to suite>
```

### Auto-fix and format

```
docker-compose exec node npm run lint
```

```
docker-compose exec node npm run format
```

## 🐳 Docker commands cheatsheet

```bash
# show existing containers
docker ps -a

# show created images
docker-compose images

# show docker volumes
docker volume ls

# show docker networks and their types
docker network ls
```

## 📚 References

[How to write a NestJS Dockerfile optimized for production](https://www.tomray.dev/nestjs-docker-production)

[NestJS and Postgres local development with Docker Compose](https://www.tomray.dev/nestjs-docker-compose-postgres)
